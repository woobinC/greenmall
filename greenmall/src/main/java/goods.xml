<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="goodsns">
	<insert id="insert" parameterType="goods">
		<selectKey keyProperty="p_No" order="BEFORE" resultType="integer">
			select nvl(max(p_no), 0) + 1 pNo from goods
		</selectKey>
		insert into goods values (#{p_No},#{c_Num},#{p_Name},#{p_Price},#{p_Sale},#{p_Img1},#{p_Img2},#{p_Cnt},sysdate ) 
	</insert>
		<select id="getTotal" resultType="integer">
		select count(*) from goods
	</select>
	
	<select resultType="goods" id="list" parameterType="map" >
select * from (select rowNum rn , a.* from(select * from goods order by p_no) a)
		where rn between #{startRow} and #{endRow} 
	</select>	
	
	<update id="update" parameterType="goods">
		update goods set 
			p_name=#{p_name},

			<if test="p_img1!=null and p_img1!=''">
				p_img1=#{p_img1},
			</if>			
			<if test="p_img2!=null and p_img2!=''">
				p_img2=#{p_img2},
			</if>			
			c_Num=#{c_Num},p_price=#{p_Price}, p_sale=#{pSale}, p_cnt=#{pCnt} ,
				where p_no=#{p_No}
	</update>
	<select id="select" parameterType="integer" resultType="goods">
		select * from goods where p_No=#{p_No}
	</select>
	
</mapper> 

